var app=angular.module("ilvesExam",[]);app.controller("addReservationsCtrl",["$scope",function(a){if(a.reservedTimes=[],a.overlap=!1,a.savedTimes=localStorage.getItem("reservedTimes"),null!==a.savedTimes)a.reservedTimes=JSON.parse(a.savedTimes),console.log(a.reservedTimes);else{var b=[],c=[],d=[];a.reservedTimes.push(b,c,d)}var e=function(b,c,d){for(var e,f,g=0;g<d.length;g++)console.log(a.reservedTimes),e=d[g].times[0],f=d[g].times[1],(b>=e&&b<=f||e>=b&&e<=c||c>=e&&c<=f||b<=e&&c>=f)&&(alert("Overlap!"),a.overlap=!0)},f=function(b,c,d){for(key in c)console.log(a.reservedTimes[d]),b<c[key].times[0]&&a.reservedTimes[d].sort(function(a,b){return parseFloat(a.times)-parseFloat(b.times)})};a.makeReservation=function(b,c,d,g){a.overlap=!1;var h=c.getTime(),i=d.getTime(),j=a.reservedTimes[b];if(e(h,i,j),a.overlap)return a.makeReservation;0==b?(j.push({room:b,times:[h,i],reservationBy:g}),console.log(j)):1==b?(j.push({room:b,times:[h,i],reservationBy:g}),console.log(j)):2==b?(j.push({room:b,times:[h,i],reservationBy:g}),console.log(j)):console.log("No value."),f(h,j,b),localStorage.setItem("reservedTimes",JSON.stringify(a.reservedTimes))},a.deleteReservation=function(b,c){console.log(c);for(var d in c)console.log(d),console.log(c[d]),b==c[d]&&c.splice(c.indexOf(b),1);localStorage.setItem("reservedTimes",JSON.stringify(a.reservedTimes))}}]);